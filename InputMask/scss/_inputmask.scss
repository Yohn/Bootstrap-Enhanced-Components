// InputMask Component Styles
// Uses Bootstrap 5.3 CSS Variables and extends form control styling

// Component-specific variables
$input-mask-placeholder-color: var(--bs-gray-400) !default;
$input-mask-focus-placeholder-color: var(--bs-gray-300) !default;
$input-mask-invalid-placeholder-color: var(--bs-danger-text-emphasis) !default;
$input-mask-transition: all 0.15s ease-in-out !default;
$input-mask-cursor-color: var(--bs-primary) !default;

// Mixin for placeholder styling
@mixin input-mask-placeholder {
	color: $input-mask-placeholder-color;
	opacity: 1;
	font-style: italic;
	letter-spacing: 0.05em;
}

// Base InputMask styles
.input-mask {
	// Extend Bootstrap form-control if not already applied
	@extend .form-control;

	// Font family for better character alignment
	font-family: var(--bs-font-monospace), monospace;
	letter-spacing: 0.02em;

	// Placeholder text styling
	&::placeholder {
		@include input-mask-placeholder;
	}

	// Focus state
	&:focus {
		// Enhanced focus styling using Bootstrap variables
		border-color: var(--bs-primary);
		box-shadow: 0 0 0 0.25rem rgba(var(--bs-primary-rgb), 0.25);

		&::placeholder {
			color: $input-mask-focus-placeholder-color;
			transition: $input-mask-transition;
		}
	}

	// Valid state
	&.is-valid {
		border-color: var(--bs-success);

		&:focus {
			border-color: var(--bs-success);
			box-shadow: 0 0 0 0.25rem rgba(var(--bs-success-rgb), 0.25);
		}

		&::placeholder {
			color: var(--bs-success-text-emphasis);
		}
	}

	// Invalid state
	&.is-invalid {
		border-color: var(--bs-danger);

		&:focus {
			border-color: var(--bs-danger);
			box-shadow: 0 0 0 0.25rem rgba(var(--bs-danger-rgb), 0.25);
		}

		&::placeholder {
			color: $input-mask-invalid-placeholder-color;
		}
	}

	// Disabled state
	&:disabled,
	&[readonly] {
		background-color: var(--bs-secondary-bg);
		opacity: 1;

		&::placeholder {
			color: var(--bs-gray-500);
		}
	}

	// Right-aligned input (for currency, etc.)
	&.text-end {
		text-align: right;
	}

	// Transition for smooth state changes
	transition: $input-mask-transition;
}

// Size variants
.input-mask-sm {
	@extend .form-control-sm;
	font-size: var(--bs-font-size-sm);
	padding: var(--bs-input-padding-y-sm) var(--bs-input-padding-x-sm);
}

.input-mask-lg {
	@extend .form-control-lg;
	font-size: var(--bs-font-size-lg);
	padding: var(--bs-input-padding-y-lg) var(--bs-input-padding-x-lg);
}

// Input group integration
.input-group {
	.input-mask {
		// Remove border radius for grouped inputs
		&:not(:first-child) {
			border-top-left-radius: 0;
			border-bottom-left-radius: 0;
		}

		&:not(:last-child) {
			border-top-right-radius: 0;
			border-bottom-right-radius: 0;
		}
	}
}

// Floating label support
.form-floating {
	.input-mask {
		// Ensure proper spacing with floating labels
		&:focus ~ label,
		&:not(:placeholder-shown) ~ label {
			opacity: 0.65;
			transform: scale(0.85) translateY(-0.5rem) translateX(0.15rem);
		}

		// Adjust label position for monospace font
		& ~ label {
			padding: var(--bs-input-padding-y) var(--bs-input-padding-x);
		}
	}
}

// Dark mode support
[data-bs-theme="dark"] {
	.input-mask {
		&::placeholder {
			color: var(--bs-gray-300);
		}

		&:focus::placeholder {
			color: var(--bs-gray-400);
		}

		&.is-invalid::placeholder {
			color: var(--bs-danger-text-emphasis);
		}
	}
}

// Pattern-specific styling
.input-mask {
	// Phone number styling
	&[data-mask="phone"],
	&.mask-phone {
		background-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23198754' viewBox='0 0 16 16'><path d='M3.654 1.328a.678.678 0 0 0-1.015-.063L1.605 2.3c-.483.484-.661 1.169-.45 1.77a17.568 17.568 0 0 0 4.168 6.608 17.569 17.569 0 0 0 6.608 4.168c.601.211 1.286.033 1.77-.45l1.034-1.034a.678.678 0 0 0-.063-1.015l-2.307-1.794a.678.678 0 0 0-.58-.122L9.98 10.654a.678.678 0 0 1-.122-.58L8.064 7.767a.678.678 0 0 0-1.015-.063L5.364 9.389a.678.678 0 0 1-.58-.122L2.477 7.473a.678.678 0 0 0-.122-.58L3.654 1.328z'/></svg>");
		background-repeat: no-repeat;
		background-position: right var(--bs-input-padding-x) center;
		background-size: 1rem;
		padding-right: calc(var(--bs-input-padding-x) + 2rem);
	}

	// SSN styling
	&[data-mask="ssn"],
	&.mask-ssn {
		background-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23fd7e14' viewBox='0 0 16 16'><path d='M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zM3 6V3a5 5 0 0 1 10 0v3a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z'/></svg>");
		background-repeat: no-repeat;
		background-position: right var(--bs-input-padding-x) center;
		background-size: 1rem;
		padding-right: calc(var(--bs-input-padding-x) + 2rem);
	}

	// Credit card styling
	&[data-mask="creditCard"],
	&.mask-credit-card {
		background-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%230d6efd' viewBox='0 0 16 16'><path d='M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v1h14V4a1 1 0 0 0-1-1H2zm13 4H1v5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V7z'/><path d='M2 10a1 1 0 0 1 1-1h1a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-1z'/></svg>");
		background-repeat: no-repeat;
		background-position: right var(--bs-input-padding-x) center;
		background-size: 1rem;
		padding-right: calc(var(--bs-input-padding-x) + 2rem);
	}

	// Date styling
	&[data-mask="date"],
	&.mask-date {
		background-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236f42c1' viewBox='0 0 16 16'><path d='M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5 0zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z'/></svg>");
		background-repeat: no-repeat;
		background-position: right var(--bs-input-padding-x) center;
		background-size: 1rem;
		padding-right: calc(var(--bs-input-padding-x) + 2rem);
	}

	// Currency styling
	&[data-mask="currency"],
	&.mask-currency {
		text-align: right;
		background-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23198754' viewBox='0 0 16 16'><path d='M4 10.781c.148 1.667 1.513 2.85 3.591 3.003V15h1.043v-1.216c2.27-.179 3.678-1.438 3.678-3.3 0-1.59-.947-2.51-2.956-3.028l-.722-.187V3.467c1.122.11 1.879.714 2.07 1.616h1.47c-.166-1.6-1.54-2.748-3.54-2.875V1H7.591v1.233c-1.939.23-3.27 1.472-3.27 3.156 0 1.454.966 2.483 2.661 2.917l.61.162v4.031c-1.149-.17-1.94-.8-2.131-1.718H4zm3.391-3.836c-1.043-.263-1.6-.825-1.6-1.616 0-.944.704-1.641 1.8-1.828v3.495l-.2-.05zm1.591 1.872c1.287.323 1.852.859 1.852 1.769 0 1.097-.826 1.828-2.2 1.939V8.73l.348.086z'/></svg>");
		background-repeat: no-repeat;
		background-position: left var(--bs-input-padding-x) center;
		background-size: 1rem;
		padding-left: calc(var(--bs-input-padding-x) + 2rem);
	}
}

// Animation for completing masks
@keyframes mask-complete {
	0% {
		box-shadow: 0 0 0 0.25rem rgba(var(--bs-success-rgb), 0.5);
	}
	50% {
		box-shadow: 0 0 0 0.5rem rgba(var(--bs-success-rgb), 0.25);
	}
	100% {
		box-shadow: 0 0 0 0.25rem rgba(var(--bs-success-rgb), 0);
	}
}

.input-mask.mask-complete {
	animation: mask-complete 0.6s ease-out;
}

// Loading state for dynamic validation
.input-mask.validating {
	background-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236c757d' viewBox='0 0 16 16'><path d='M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z'/><path d='M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z'/></svg>");
	background-repeat: no-repeat;
	background-position: right var(--bs-input-padding-x) center;
	background-size: 1rem;
	animation: spin 1s linear infinite;
}

@keyframes spin {
	from {
		transform: rotate(0deg);
	}
	to {
		transform: rotate(360deg);
	}
}

// High contrast mode support
@media (prefers-contrast: high) {
	.input-mask {
		border-width: 2px;

		&:focus {
			outline: 2px solid var(--bs-primary);
			outline-offset: 2px;
		}

		&.is-valid {
			border-color: var(--bs-success);
			outline-color: var(--bs-success);
		}

		&.is-invalid {
			border-color: var(--bs-danger);
			outline-color: var(--bs-danger);
		}
	}
}

// Reduced motion support
@media (prefers-reduced-motion: reduce) {
	.input-mask {
		transition: none;
	}

	.input-mask.mask-complete,
	.input-mask.validating {
		animation: none;
	}
}