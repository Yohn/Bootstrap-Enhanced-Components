<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Bootstrap 5.3.3 JSON Table</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
	<link href="scss/floating-labels.css" rel="stylesheet">
	<style>

th.sortable {
			cursor: pointer;
			user-select: none;
			white-space: nowrap;
		}
		th.sortable:hover {
			background-color: rgba(var(--bs-emphasis-color-rgb), 0.05);
		}
		th.sortable .sort-icon {
			opacity: 0.5;
			font-size: 0.85em;
			display: inline-block;
		}
		th.sortable:hover .sort-icon {
			opacity: 1;
		}
		th.sortable .sort-icon i.bi-arrow-up,
		th.sortable .sort-icon i.bi-arrow-down {
			opacity: 1;
			color: var(--bs-primary);
		}
		.toast:not(.show){
			display:block;
		}
		.toast.fade {
			opacity: 0;
		}
		.toast.fade.show {
			opacity: 1;
		}
	</style>
</head>
<body>
<div class="container-fluid mt-4 px-3">
	<div class="row-fluid">
		<div class="col-lg-12 col-xl-8 mx-auto">
			<div class="card">

				<div class="card-header border-bottom-0">
					<div class="row">
						<div class="col-md-6 col-sm-12 mb-2 mb-md-0">
							<div class="input-group">
								<label class="input-group-text" for="rowsPerPageSelect">Show</label>
								<select id="rowsPerPageSelect" class="form-select" style="max-width: 100px;">
									<option value="5">5</option>
									<option value="10">10</option>
									<option value="25">25</option>
									<option value="50">50</option>
									<option value="100">100</option>
								</select>
								<span class="input-group-text">entries</span>
							</div>
						</div>
						<div class="col-md-6 col-sm-12">
							<div class="input-group">
								<span class="input-group-text" id="globalSearchIcon"><i class="bi bi-search"></i></span>
								<input id="globalSearch" type="text" class="form-control" placeholder="Search all rows" aria-label="Search all rows">
							</div>
						</div>
					</div>
				</div>
				<div class="table-responsive">
					<table id="jsonTable" class="table table-striped table-hover mb-0 border-top">
						<thead></thead>
						<tbody></tbody>
						<tfoot></tfoot>
					</table>
				</div>
				<div class="card-footer border-top-0 d-flex justify-content-between">
					<div class="input-group">
						<span class="input-group-text bg-light-subtle" id="recordCount"></span>
					</div>
					<nav>
						<ul id="pagination" class="pagination justify-content-end mb-0"></ul>
					</nav>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="editModalLabel">Edit Row</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body"></div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary save-edit">Save Changes</button>
			</div>
		</div>
	</div>
</div>

<div id="toastContainer" aria-live="polite" aria-atomic="true"
	class="toast-container position-absolute top-50 start-50 translate-middle">
	<div class="toast fade" role="alert" aria-live="assertive" aria-atomic="true">
		<div class="toast-header">
			<strong class="me-auto">Row Edit</strong>
			<button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
		</div>
		<div class="toast-body"></div>
	</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/JsonTable.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
	const table = new JsonTable({
		jsonUrl: 'ExampleJS/data.json',
		rowsPerPage: 5,
		rowsPerPageOptions: [5, 10, 25, 50, 100],
		container: '#jsonTable',
		globalSearch: '#globalSearch',
		pagination: '#pagination',
		rowsPerPageSelect: '#rowsPerPageSelect',
		foundEntriesContainer: '#recordCount',
		foundEntriesText: 'XX Entries Found',
		foundSearchedText: 'XX of XX Entries Found',
		allowEdit: true,
		editSaveUrl: 'test.json',
		editPlacement: 'start',
		editSaveAdditionalData: {"additional": "data"},
		columns: [
			{ key: 'ID', title: 'ID', searchType: false, editFieldType: false },
			{ key: 'FirstName', title: 'First Name', searchType: 'text', editFieldType: 'text', columnIcon: 'bi bi-person-raised-hand' },
			{ key: 'LastName', title: 'Last Name', searchType: 'text', editFieldType: 'text', columnIcon: 'bi bi-person-raised-hand' },
			{ key: 'Age', title: 'Age', searchType: 'select', editFieldType: 'number', columnIcon: 'bi bi-cake2' },
			{ key: 'City', title: 'City', searchType: 'text', editFieldType: 'text', columnIcon: 'bi bi-buildings' },
			{ key: 'State', title: 'State', searchType: 'text', editFieldType: 'text', columnIcon: 'bi bi-globe-americas' },
			{ key: 'Company', title: 'Company', searchType: 'text', editFieldType: 'text', columnIcon: 'bi bi-building' },
			{ key: 'JobTitle', title: 'JobTitle', searchType: 'text', editFieldType: 'text', columnIcon: 'bi bi-person-workspace' },
		]

		// Example with date sorting:
		// {
		// 	key: 'createdDate',
		// 	title: 'Created',
		// 	searchType: 'text',
		// 	editFieldType: 'date',
		// 	sortValue: (value) => new Date(value).getTime()
		// },
		// {
		// 	key: 'modifiedDate',
		// 	title: 'Modified',
		// 	searchType: false,
		// 	editFieldType: 'datetime-local',
		// 	sortValue: (value) => new Date(value).getTime()
		// }
	});

	// Example event listeners
	const tableElement = document.querySelector('#jsonTable');

	// Listen to data load event
	tableElement.addEventListener('load.yo.jsontable', function(e) {
		console.log('Data loaded:', e.detail.data.length, 'rows');
	});

	// Listen to sort events
	tableElement.addEventListener('sort.yo.jsontable', function(e) {
		console.log('Sorting:', e.detail.column, e.detail.newOrder);
		// You can prevent sorting by calling:
		// e.preventDefault();
	});

	tableElement.addEventListener('sorted.yo.jsontable', function(e) {
		console.log('Sorted by:', e.detail.column, e.detail.order);
	});

	// Listen to filter events
	tableElement.addEventListener('filter.yo.jsontable', function(e) {
		console.log('Filtering:', e.detail.filterType, e.detail);
	});

	tableElement.addEventListener('filtered.yo.jsontable', function(e) {
		console.log('Filtered results:', e.detail.resultCount, 'rows');
	});

	// Listen to page change events
	tableElement.addEventListener('pagechange.yo.jsontable', function(e) {
		console.log('Changing page from', e.detail.oldPage, 'to', e.detail.newPage);
	});

	// Listen to edit events
	tableElement.addEventListener('edit.yo.jsontable', function(e) {
		console.log('Editing row:', e.detail.rowIndex, e.detail.rowData);
	});

	// Listen to save events
	tableElement.addEventListener('save.yo.jsontable', function(e) {
		console.log('Saving:', e.detail.formData);
		// Validate before save:
		// if (!e.detail.formData.email.includes('@')) {
		//     alert('Invalid email');
		//     e.preventDefault(); // Cancel save
		// }
	});

	tableElement.addEventListener('saved.yo.jsontable', function(e) {
		console.log('Save successful:', e.detail.response);
	});

	// Listen to row click events
	tableElement.addEventListener('rowclick.yo.jsontable', function(e) {
		console.log('Row clicked:', e.detail.rowData);
	});
});
</script>
</body>
</html>